/**
 * Gradle task to generate string mocks for BaseTest
 * 
 * Usage: ./gradlew generateStringMocks
 */

task generateStringMocks {
    group = 'testing'
    description = 'Generate mock statements for StringsIds by parsing XML files'
    
    doLast {
        def scriptPath = project.rootDir.toPath().resolve('scripts/generate-string-mocks.sh')
        
        if (!scriptPath.toFile().exists()) {
            throw new GradleException("Script not found: $scriptPath")
        }
        
        println "ðŸ” Running string mock generator..."
        
        def process = new ProcessBuilder('bash', scriptPath.toString())
            .directory(project.rootDir)
            .redirectErrorStream(true)
            .start()
        
        process.inputStream.eachLine { line ->
            println line
        }
        
        int exitCode = process.waitFor()
        
        if (exitCode != 0) {
            throw new GradleException("Script failed with exit code: $exitCode")
        }
        
        println "âœ… String mock generation completed!"
    }
}
